@using (Ajax.BeginForm("AddReview", "Ad", null, new AjaxOptions { UpdateTargetId = "list_reviews" }, null))
{
    <br />
    if (!User.Identity.IsAuthenticated)
    {
        <div class="row">
            <div class="col-md-3">Your name:</div>
            <div class="col-md-9">
                <input name="UserName" style="display:block; height:auto; max-width:100%;  min-width:100%; border: none;" type="text" />
            </div>
        </div>
        <br />
    }
    else
    {
        <input name="UserName" type="hidden" value="@User.Identity.Name" />
    }
    <div class="row">
        <div class="col-md-2">Text:</div>
        <div class="col-md-10">
            <textarea name="Text" style="display:block; height:auto; max-width:100%;  min-width:100%; border: none;"></textarea>
        </div>
    </div>
    <br />
    <div class="row">
        <div class="col-md-2">Dignity:</div>
        <div class="col-md-10">
            <textarea name="Dignity" style="display:block; height:auto; max-width:100%; min-width:100%; border: none;"></textarea>
        </div>
    </div>
    <br />
    <div class="row">
        <div class="col-md-2">Defects:</div>
        <div class="col-md-10">
            <textarea name="Defects" style="display:block; height:auto; max-width:100%;  min-width:100%; border: none;"></textarea>
        </div>
    </div>
    <br />
    <div class="row">
        <div class="col-md-8">
            <div id="reviewStars-input">
                <input onclick="SetStars(4)" id="star-4" type="radio" name="reviewStars" />
                <label title="gorgeous" for="star-4"></label>
                <input onclick="SetStars(3)" id="star-3" type="radio" name="reviewStars" />
                <label title="good" for="star-3"></label>
                <input onclick="SetStars(2)" id="star-2" type="radio" name="reviewStars" />
                <label title="regular" for="star-2"></label>
                <input onclick="SetStars(1)" id="star-1" type="radio" name="reviewStars" />
                <label title="poor" for="star-1"></label>
                <input onclick="SetStars(0)" id="star-0" type="radio" name="reviewStars" />
                <label title="bad" for="star-0"></label>
            </div>
            <input id="stars" name="Stars" value="" type="hidden" />
        </div>
        <div class="col-md-4">
            <input name="AdId" value="@ViewBag.AdId" type="hidden" />
            <button id="sendHub" type="button" class="btn btn-block btn-success">Post</button>
            <input id="sendReview" type="submit" class="hidden" />
        </div>
    </div>
}

<script src="~/Scripts/jquery.signalR-1.1.4.js"></script>
<!--Reference the autogenerated SignalR hub script. -->
<script src="~/signalr/hubs"></script>
<script>
    $(function () {
        // Reference the auto-generated proxy for the hub.
        var review = $.connection.reviewHub;
        // Create a function that the hub can call back to display messages.
        review.client.newReview = function (adId) {
            if (adId == $("[name='AdId']").val() && $("#newReview") != null) {
                if ($("#newReview").html() == "") {
                    $("#newReview").empty().append('<div id="getNewReview" class="alert alert-info text-center" role="alert" onclick="GetReviews()"><p style="font-size: 14pt;">New review...</p></div>');
                }
                //var countReview = parseInt($("#countReviews").html()) + 1;
                //$("#countReviews").empty().append(countReview);
            }
        };
        // Start the connection.
        $.connection.hub.start().done(function () {
            $('#sendHub').click(function () {
                // Call the Send method on the hub.
                review.server.send($("[name='AdId']").val());
                $('#sendReview').click();
                GetAddReviews();
            });
        });
    });
</script>